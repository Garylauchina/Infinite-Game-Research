# TODO_V5.2 (Revised)

> 本文件用于约束 V5.2 的开发边界、实验目标与推进顺序  
> 目标不是"做更多"，而是**确认 V5.2 是一个已完成、可被引用、可被复现实验的最小系统升级**

---

## 0. Definition of Done (DoD) — V5.2 完成判定标准

V5.2 被认为"完成"，当且仅当同时满足以下条件：

1. ✅ P0–P3 全部回归测试通过
2. ✅ P3 长跑实验（≥500k ticks）完成，系统稳定
3. ✅ K = 1 时，与 V5.0 行为轨迹 **100% 重合**
4. ✅ K > 1 不引入新的可达结构空间，仅影响探索速度
5. ✅ collapse_proxy 能稳定区分三类状态：
   - 单点吸引子塌缩（低熵）
   - 均匀噪声塌缩（高熵、无骨架）
   - 健康结构（中高熵、有骨架）
6. ✅ 所有新增机制均满足：
   - tick-local（无跨 tick 记忆）
   - 无策略、无学习、无智能
   - 不引入新世界状态维度

---

## 1. Phase 1–4：核心机制（已完成，冻结）

> ⚠️ 本阶段 **机制已冻结（Mechanism Frozen）**  
> 任何修改都必须开启 V5.3 分支

### Phase 1: 并行探针机制（完成）
- Player 每 tick 生成 K 个探针
- K 定义为 **行为采样密度（Behavior Sampling Density）**
- K ≠ 订单厚度 / 持仓 / 交易频率

### Phase 2: 新体验函数（完成）

```
instant_reward = 
    0.4 * success_rate
  + 0.2 * match_dispersion
  + 0.4 * complexity
```

- ❌ 不再直接惩罚失败
- 失败通过分布结构间接影响体验

### Phase 3: 结构塌缩代理（完成）

```
collapse = |2 * H_price_norm - 1|

if H_price_norm > 0.8:
    collapse *= active_protocols_ratio
```

- H_price ≠ H_transfer（已审计分离）
- collapse 只作为 Chaos Factor 的放大器
- Chaos 只惩罚 **结构塌缩**，不惩罚成交率

### Phase 4: 回归与长跑验证（完成）
- P0–P3 回归测试通过
- 长跑实验完成
- 结论成立：
  - K 改变探索速度
  - 不改变结构空间边界

---

## 2. Phase 4.5：结构行为验证（只观测，不改机制）

> 🎯 当前唯一允许推进的阶段  
> 🚫 禁止修改任何核心代码或参数

### 目标

验证 V5.2 引入的"并行探针 + 塌缩惩罚"机制，  
是否在**长期运行中自然显影出交互阻抗与探索上限**

### 明确约束

- ❌ 不新增 world state
- ❌ 不新增 reward 项
- ❌ 不引入记忆、学习、策略
- ❌ 不修改 Chaos / Complexity 定义

### 允许工作内容

- ✅ 统计分析
- ✅ 数据切片
- ✅ 可视化（Camera / Projection）
- ✅ 不改变数据语义的派生指标

### 核心观测问题

- [ ] N(t) 是否在长跑中出现自然上限
- [ ] collapse_proxy 是否随 N 增长而系统性抬升
- [ ] 高 K 是否更快进入同一塌缩区间
- [ ] 成交价格分布是否经历：
      有骨架 → 扩散 → 均匀噪声
- [ ] 是否存在"探索收益递减区间"

> 若 N 无限增长且无塌缩信号：
> → 判定为 **机制漏洞**，而非"现实合理性"

---

## 3. 明确不在 V5.2 回答的问题（边界声明）

以下问题 **不属于 V5.2 研究范围**：

- ❌ 如何避免结构最终塌缩
- ❌ 是否存在永动的复杂系统
- ❌ 学习型 / 智能 agent 如何介入
- ❌ 多市场耦合与注意力分配
- ❌ 政策 / 干预 / 治理如何映射

这些问题应属于：
- V5.3+
- 或独立论文 / 独立系统

---

## 4. 版本纪律

- V5.2：结构生成与塌缩显影（最小、无智能）
- 任何新增机制 → 新分支（V5.3）
- backend-demo 仅用于展示，不得反向影响 main

---

## 5. 当前状态

- [x] 核心机制完成
- [x] 回归测试完成
- [x] 长跑实验完成
- [ ] Phase 4.5 结构行为验证（进行中）

---

## 附录：实验数据归档

### P3 长跑验证（2026-01-26）

| Seed | K | collapse_mean | H_price_mean | active_ratio | 结论 |
|------|---|---------------|--------------|--------------|------|
| 0 | 1 | 0.923 | 0.962 | 1.0 | 均匀噪声塌缩 |
| 0 | 3 | 0.970 | 0.985 | 1.0 | 均匀噪声塌缩 |
| 1 | 1 | 0.986 | 0.993 | 1.0 | 均匀噪声塌缩 |
| 1 | 3 | 0.980 | 0.990 | 1.0 | 均匀噪声塌缩 |
| 2 | 1 | 0.854 | 0.927 | 1.0 | 均匀噪声塌缩 |
| 2 | 3 | 0.954 | 0.977 | 1.0 | 均匀噪声塌缩 |

详细报告：`experiments/output/v52_p3_longrun/EXPERIMENT_V5_2_P3_LONGRUN_REPORT.md`

---

**最后更新**: 2026-01-26
